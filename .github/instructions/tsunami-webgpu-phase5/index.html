<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tsunami WebGPU • Phase 3</title>
    <style>
      html, body {
        margin: 0;
        height: 100%;
        background: #0b0f14;
        color: #e6eef8;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
      }
      #app { height: 100%; display: grid; grid-template-columns: 320px 1fr; }
      #panel {
        padding: 16px;
        border-right: 1px solid rgba(255,255,255,0.08);
        background: rgba(255,255,255,0.02);
      }
      h1 { font-size: 16px; margin: 0 0 8px; letter-spacing: 0.2px; }
      .hint { font-size: 12px; opacity: 0.75; line-height: 1.35; margin-bottom: 12px; }
      .row { margin: 10px 0; display: grid; gap: 6px; }
      label { font-size: 12px; opacity: 0.85; }
      input[type="file"], select, button, input[type="range"] { width: 100%; }
      select, button, input[type="range"] {
        background: rgba(255,255,255,0.06);
        color: #e6eef8;
        border: 1px solid rgba(255,255,255,0.10);
        border-radius: 10px;
        padding: 8px 10px;
      }
      input[type="range"] { padding: 10px; }
      button { cursor: pointer; }
      #palette { display: grid; grid-template-columns: repeat(6, 1fr); gap: 6px; margin-top: 8px; }
      .swatch { height: 22px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.10); }
      #viewport { position: relative; }
      #c { width: 100%; height: 100%; display: block; }
      #status {
        position: absolute; left: 12px; bottom: 12px;
        background: rgba(0,0,0,0.45);
        border: 1px solid rgba(255,255,255,0.10);
        padding: 8px 10px; border-radius: 12px;
        font-size: 12px; opacity: 0.92;
        max-width: min(520px, calc(100% - 24px));
        backdrop-filter: blur(10px);
      }
      .ok { color: #7CFC9A; }
      .bad { color: #FF7A7A; }
    </style>
  </head>
  <body>
    <div id="app">
      <div id="panel">
        <h1>Tsunami WebGPU • Phase 3</h1>
        <div class="hint">
          Phase 3: real SPH (GPU hash-grid via atomics) + tsunami wave-maker + coastline run-up, with image → palette style transfer.
          Next big steps: surface reconstruction + refraction, then terrain + destruction coupling.
        </div>

        <div class="row">
          <label>Style image (drives palette + lighting)</label>
          <input id="img" type="file" accept="image/*" />
          <div id="palette"></div>
        </div>

        <div class="row">
          <label>Physics mode</label>
          <select id="mode">
            <option value="sph">SPH (hash-grid, Phase 3)</option>
            <option value="pbf">PBF (coming next)</option>
            <option value="mpm">MLS-MPM (coming next)</option>
          </select>
        </div>

        <div class="row">
          <label>Quality / Particle count</label>
          <input id="quality" type="range" min="0" max="2" value="1" />
        </div>

        <div class="row">
          <button id="reset">Reset sim</button>
        </div>

        <div class="hint">
          Tip: for “tsunami destruction”, add a heightfield + voxel obstacle grid, then couple water impulses to fracture rules.
        </div>
      </div>

      <div id="viewport">
        <canvas id="c"></canvas>
        <div id="status">Initializing…</div>
      </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
